)
)
# Download snowfall data
df_snowfall <- df_snowfall %>%
group_by(pass_num, pass_year) %>%
mutate(snowfall = map(url, download_snowfall_data)) %>%
select(-url) %>%
unnest(snowfall) %>%
select(-pass_num, -pass_year, -displayOrder) %>%
rename(avg_new_snowfall_in = avgNewSnowfallInches,
avg_tot_snowfall_in = avgTotalSnowfallInches,
mo_num = monthNum) %>%
group_by(pass_num, pass_year, mo_num) %>%
mutate(date = as.Date(paste(year, mo_num, 1, sep = "-"))) %>%
select(pass, year, month, date, avg_new_snowfall_in, avg_tot_snowfall_in)
# Save snowfall data
write_csv(df_snowfall, snowfall_file)
} else {
df_snowfall <- read_csv(snowfall_file, show_col_types = FALSE)
}
return(df_snowfall)
}
# Get snowfall data
snow_data <- get_snowfall(df_pass)
# Merge ENSO info and remove rows with NA values
snow_data <- snow_data %>% left_join(enso_map, by = "year")
# Save combined CSV
write_csv(snow_data, here(data_dir, "cascade_snowfall.csv"))
# Prepare factor variable for x-axis labels and remove rows with NA values
mos <- c(10:12, 1:5)
snow_data <- snow_data %>%
mutate(mo_num_char =
factor(str_pad(as.character(mo_num), 2, pad = "0"),
levels = str_pad(as.character(mos), 2, pad = "0"),
labels = month.abb[mos],
ordered = TRUE)) %>%
drop_na()
# Plot Monthly Avg. Total Snowfall at WA Cascade Passes
ggplot(snow_data,
aes(x = mo_num_char,
y = avg_tot_snowfall_in,
color = ENSO, group = pass_year)) +
geom_point(alpha = 0.5) +
facet_wrap(~ pass, scales = "free_y") +
scale_color_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
x = "Month",
y = "Monthly Avg. Total Snowfall (inches)", color = "ENSO Phase") +
theme_minimal() +
theme(axis.text.x = element_text(hjust = 1))
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes.png"))
# Prepare data for bar plot
summarized_snow_data <- snow_data %>%
group_by(pass, ENSO) %>%
summarise(avg_tot_snowfall_in = mean(avg_tot_snowfall_in),
.groups = "drop")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = fct_rev(pass), group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)", color = "ENSO Phase")
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes_bar.png"))
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = fct_rev(pass), group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes_bar.png"))
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = fct_rev(pass), group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Prepare data for bar plot
summarized_snow_data <- snow_data %>%
group_by(pass, ENSO) %>%
summarise(max_avg_tot_snowfall_in = max(avg_tot_snowfall_in, na.rm = TRUE),
.groups = "drop")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = max_avg_tot_snowfall_in, y = fct_rev(pass), group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Prepare data for bar plot
summarized_snow_data <- snow_data %>%
group_by(pass, ENSO) %>%
summarise(avg_tot_snowfall_in = mean(avg_tot_snowfall_in),
.groups = "drop")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = fct_rev(pass), group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes_bar.png"))
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes_bar.png"))
# Plot Monthly Avg. Total Snowfall at WA Cascade Passes
ggplot(snow_data,
aes(x = mo_num_char,
y = avg_tot_snowfall_in,
color = ENSO, group = pass_year)) +
geom_point(alpha = 0.5) +
facet_wrap(~ pass, scales = "free_y") +
scale_color_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
x = "Month",
y = "Monthly Avg. Total Snowfall (inches)", color = "ENSO Phase") +
theme_minimal()
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes.png"))
# Prepare data for bar plot
summarized_snow_data <- snow_data %>%
group_by(pass, ENSO) %>%
summarise(avg_tot_snowfall_in = mean(avg_tot_snowfall_in),
.groups = "drop")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes_bar.png"))
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_box(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
facet_wrap(~ pass, scales = "free_y") +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass)) +
geom_boxplot(aes(fill = ENSO)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO, group = pass)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO, group = ENSO)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot() +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, fill = ENSO)) +
geom_boxplot() +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot() +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, group = pass)) +
geom_boxplot(fill = ENSO) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
y = pass,
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(fill = ENSO) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Prepare data for bar plot
summarized_snow_data <- snow_data %>%
group_by(pass, ENSO) %>%
summarise(avg_tot_snowfall_in = mean(avg_tot_snowfall_in),
.groups = "drop")
summarized_snow_data
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(fill = ENSO) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
aes(fill = ENSO, group = ENSO)
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO, group = pass)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_boxplot(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, group = ENSO)) +
geom_boxplot(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot Monthly Avg. Total Snowfall at WA Cascade Passes
ggplot(snow_data,
aes(x = mo_num_char,
y = avg_tot_snowfall_in,
color = ENSO, group = pass_year)) +
geom_point(alpha = 0.5) +
facet_wrap(~ pass, scales = "free_y") +
scale_color_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
x = "Month",
y = "Monthly Avg. Total Snowfall (inches)", color = "ENSO Phase") +
theme_minimal()
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Save the plot as a PNG file
ggsave(here(figures_dir, "monthly_avg_tot_snowfall_wa_cascade_passes_bar.png"))
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_col(aes(fill = ENSO)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
# Plot summarized data as bar plot
ggplot(summarized_snow_data,
aes(x = avg_tot_snowfall_in, y = pass, group = ENSO)) +
geom_col(aes(fill = ENSO), position = position_dodge(reverse = TRUE)) +
scale_fill_manual(values =
c("El Niño" = "red",
"La Niña" = "blue",
"Neutral" = "gray")) +
theme_minimal() +
labs(title = paste0("Monthly Avg. Total Snowfall at WA Cascade Passes (",
min(pass_year), "-", max(pass_year), ")"),
caption = "Data Sources: WSDoT Snowfall report and GGWeather ENSO ONI",
y = "Pass",
x = "Monthly Avg. Total Snowfall (inches)")
